<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <title>State Spending Vs. Graduation Rate</title>
  <meta name="author" content="Lux">
  <meta name="description" content="A look at state spending vs graduation rate data">
  <meta content="text/html" http-equiv="Content-type" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <script src="https://cdn.plot.ly/plotly-2.6.3.min.js"></script>
</head>

<body>
  <%- include ('partials/navbar'); %>
  <%- include ('partials/header'); %>


  <% let microStateNames = ["California", "Colorado", "Florida", "Iowa", "Louisiana", "Missouri", "NewMexico", "NewYork", "Oklahoma", "Texas", "WestVirginia"]; %>
  <h1> <span style ="font-weight:normal"> <%= name %> </span> </h1>
    <%if(name == "California"){%>

<%}%>
    <% let previous = microStateNames[microStateNames.indexOf(name)-1] %>
    <% let previousFile = ["micro", previous, ".html"].join("") %>
    <a href= <%= previousFile %> > <%= previous %> </a>


    <% let next = microStateNames[microStateNames.indexOf(name)+1] %>
    <% let nextFile = ["micro", next, ".html"].join("") %>
    <a href= <%= nextFile %> > <%= next %> </a>
    <br>
    <span style ="font-weight:normal">
    This infographic shows a correlation between increased spending per student and graduation rate.
    The lowest graduation rate corresponds with the lowest spending, and vice versa
    (although there are two districts with different spendings and the same graduation rate).
    Compared to the infographic of the entire nation, California has an upward trend in the numerical value
    of graduation rates relative to spending per student that is not visible in the national infographic.
    This would suggest that this trend is isolated and is not representative of the nation if states are compared.
    when examining data for the country.

    </span>
    <div id="tester" style="width:1000px;height:550px;"></div>
    <%const spending = [];%>
    <%const rates = [];%>
    <% for(let i=0; i<data.length; i++){ %>
    <%  spending.push(data[i].spending);%>
    <%  rates.push(data[i].gradRate);%>
    <%}%>
    <%let spendingEJS = spending%>
    <% let ratesEJS = rates%>

    <script>
    let spendJS = [];
    let spendingJS = "<%=spendingEJS%>";
    let spendArrayJS = spendingJS.split(",");
    let ratesJS = [];
    let rateJS = "<%=ratesEJS%>)";
    let rateArrayJS = rateJS.split(",");
    for(let i=0; i<spendArrayJS.length;i++){
      spendJS.push(parseInt(spendArrayJS[i]));
    }
    for(let i=0; i<rateArrayJS.length;i++){
      ratesJS.push(parseInt(rateArrayJS[i]));
    }
      spendJS.sort(function (a, b) {  return a - b;  });
      ratesJS.sort(function (a, b) {  return a - b;  });
      lowX = spendJS[0]-2000;
      highX = spendJS[5]+2000;
      lowY = ratesJS[0]-10;
      highY = ratesJS[5]+10;
      console.log(spendJS);
    TESTER = document.getElementById('tester');

    var layout = {xaxis: {title: "Spending per Student (in US Dollars)", range: [lowX, highX]}, yaxis: {title: "Graduation Rate (Percentage)",  range: [lowY, highY]}};
    Plotly.newPlot( TESTER,[{ x: spendJS, y: ratesJS, mode: "markers", type:"scatter" }],layout );
    </script>

  <%- include ('partials/footer'); %>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

</body>

</html>
